<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>„Çµ„Ç¶„É≥„Éâ„Éê„Çπ Èü≥Èüø„É™„É©„ÇØ„Çº„Éº„Ç∑„Éß„É≥</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', 'Meiryo', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            text-align: center;
            max-width: 1000px;
            width: 100%;
        }

        h1 {
            color: #333;
            margin-bottom: 30px;
            font-size: 2.5em;
        }

        .session-selector {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .session-btn {
            background: #f8f9fa;
            color: #333;
            border: 2px solid #ddd;
            padding: 15px 25px;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1em;
            min-width: 150px;
        }

        .session-btn:hover {
            background: #e9ecef;
            border-color: #667eea;
            transform: translateY(-2px);
        }

        .session-btn.active {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border-color: #667eea;
        }

        .sound-visualizer {
            width: 100%;
            height: 300px;
            background: linear-gradient(180deg, #0B1426 0%, #1a1a2e 100%);
            position: relative;
            overflow: hidden;
            border-radius: 15px;
            margin: 30px 0;
            border: 3px solid #333;
        }

        .sound-wave {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 100px;
            background: linear-gradient(180deg, transparent, rgba(102, 126, 234, 0.3));
            border-radius: 50% 50% 0 0;
            animation: wave 3s infinite ease-in-out;
        }

        .sound-wave:nth-child(2) {
            animation-delay: -1s;
            background: linear-gradient(180deg, transparent, rgba(76, 175, 80, 0.3));
        }

        .sound-wave:nth-child(3) {
            animation-delay: -2s;
            background: linear-gradient(180deg, transparent, rgba(255, 193, 7, 0.3));
        }

        .sound-wave:nth-child(4) {
            animation-delay: -0.5s;
            background: linear-gradient(180deg, transparent, rgba(156, 39, 176, 0.3));
        }

        @keyframes wave {
            0%, 100% { 
                transform: translateY(0) scaleY(1); 
            }
            50% { 
                transform: translateY(-30px) scaleY(1.3); 
            }
        }

        .frequency-display {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .frequency-bar {
            width: 8px;
            background: linear-gradient(180deg, #667eea, #764ba2);
            border-radius: 4px;
            animation: frequency 2s infinite ease-in-out;
        }

        .frequency-bar:nth-child(1) { height: 60px; animation-delay: 0s; }
        .frequency-bar:nth-child(2) { height: 80px; animation-delay: 0.2s; }
        .frequency-bar:nth-child(3) { height: 100px; animation-delay: 0.4s; }
        .frequency-bar:nth-child(4) { height: 120px; animation-delay: 0.6s; }
        .frequency-bar:nth-child(5) { height: 140px; animation-delay: 0.8s; }
        .frequency-bar:nth-child(6) { height: 120px; animation-delay: 1s; }
        .frequency-bar:nth-child(7) { height: 100px; animation-delay: 1.2s; }
        .frequency-bar:nth-child(8) { height: 80px; animation-delay: 1.4s; }
        .frequency-bar:nth-child(9) { height: 60px; animation-delay: 1.6s; }

        @keyframes frequency {
            0%, 100% { transform: scaleY(1); }
            50% { transform: scaleY(1.5); }
        }

        .sound-types {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 30px 0;
        }

        .sound-type {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .sound-type:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            border-color: #667eea;
        }

        .sound-type.active {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border-color: #667eea;
        }

        .sound-icon {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .volume-control {
            margin: 20px 0;
        }

        .volume-control label {
            display: block;
            margin-bottom: 10px;
            color: #333;
            font-weight: bold;
        }

        .volume-slider {
            width: 100%;
            max-width: 300px;
            height: 8px;
            border-radius: 5px;
            background: #ddd;
            outline: none;
            -webkit-appearance: none;
        }

        .volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
        }

        .volume-slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
            border: none;
        }

        .timer {
            font-size: 2.5em;
            color: #333;
            margin: 20px 0;
            font-weight: bold;
        }

        .stats-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .stat-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            border: 1px solid #e9ecef;
        }

        .stat-label {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 1.3em;
            font-weight: bold;
            color: #667eea;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .control-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1em;
        }

        .control-btn:hover {
            background: #5a6fd8;
            transform: scale(1.05);
        }

        .control-btn.paused {
            background: #ff9800;
        }

        .back-button {
            background: #6c757d;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            margin-top: 20px;
        }

        .back-button:hover {
            background: #5a6268;
            transform: scale(1.05);
        }

        .result-panel {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            text-align: left;
        }

        .result-panel h3 {
            color: #667eea;
            margin-bottom: 15px;
        }

        .performance-rating {
            font-size: 1.5em;
            font-weight: bold;
            margin: 1em 0;
            padding: 0.8em;
            border-radius: 10px;
        }

        .rating-excellent { background: #d4edda; color: #155724; }
        .rating-good { background: #d1ecf1; color: #0c5460; }
        .rating-average { background: #fff3cd; color: #856404; }
        .rating-poor { background: #f8d7da; color: #721c24; }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            .sound-visualizer {
                height: 250px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéµ „Çµ„Ç¶„É≥„Éâ„Éê„Çπ Èü≥Èüø„É™„É©„ÇØ„Çº„Éº„Ç∑„Éß„É≥</h1>
        <div class="description">
            Áôí„Åó„ÅÆÈü≥„Åß„É™„É©„ÇØ„Çº„Éº„Ç∑„Éß„É≥„Çí‰ΩìÈ®ì„Åó„Åæ„Åó„Çá„ÅÜ„ÄÇÊßò„ÄÖ„Å™Èü≥„ÅÆÁµÑ„ÅøÂêà„Çè„Åõ„ÅßÂøÉË∫´„Çí„É™„Éï„É¨„ÉÉ„Ç∑„É•„Åß„Åç„Åæ„Åô„ÄÇ
        </div>

        <div class="session-selector">
            <button class="session-btn active" data-session="relaxation">„É™„É©„ÇØ„Çº„Éº„Ç∑„Éß„É≥</button>
            <button class="session-btn" data-session="meditation">ÁûëÊÉ≥</button>
            <button class="session-btn" data-session="sleep">Áù°Áú†</button>
            <button class="session-btn" data-session="focus">ÈõÜ‰∏≠</button>
            <button class="session-btn" data-session="custom">„Ç´„Çπ„Çø„É†</button>
        </div>

        <div class="sound-visualizer" id="soundVisualizer">
            <div class="sound-wave"></div>
            <div class="sound-wave"></div>
            <div class="sound-wave"></div>
            <div class="sound-wave"></div>
        </div>

        <div class="frequency-display" id="frequencyDisplay">
            <div class="frequency-bar"></div>
            <div class="frequency-bar"></div>
            <div class="frequency-bar"></div>
            <div class="frequency-bar"></div>
            <div class="frequency-bar"></div>
            <div class="frequency-bar"></div>
            <div class="frequency-bar"></div>
            <div class="frequency-bar"></div>
            <div class="frequency-bar"></div>
        </div>

        <div class="sound-types">
            <div class="sound-type" data-sound="nature">
                <div class="sound-icon">üåø</div>
                <div class="sound-title">Ëá™ÁÑ∂Èü≥</div>
                <div class="sound-desc">Èõ®„ÄÅÈ¢®„ÄÅÈ≥•„ÅÆ„Åï„Åà„Åö„Çä</div>
            </div>
            <div class="sound-type" data-sound="ocean">
                <div class="sound-icon">üåä</div>
                <div class="sound-title">Êµ∑„ÅÆÈü≥</div>
                <div class="sound-desc">Ê≥¢„ÅÆÈü≥„ÄÅÊΩÆÈ®í</div>
            </div>
            <div class="sound-type" data-sound="forest">
                <div class="sound-icon">üå≤</div>
                <div class="sound-title">Ê£Æ„ÅÆÈü≥</div>
                <div class="sound-desc">Êú®„ÄÖ„ÅÆ„Åñ„Çè„ÇÅ„Åç„ÄÅÂ∞èÂ∑ù</div>
            </div>
            <div class="sound-type" data-sound="white-noise">
                <div class="sound-icon">‚ö™</div>
                <div class="sound-title">„Éõ„ÉØ„Ç§„Éà„Éé„Ç§„Ç∫</div>
                <div class="sound-desc">ÈùôÂØÇ„ÇíÊºîÂá∫</div>
            </div>
            <div class="sound-type" data-sound="ambient">
                <div class="sound-icon">üéº</div>
                <div class="sound-title">„Ç¢„É≥„Éì„Ç®„É≥„Éà</div>
                <div class="sound-desc">Áí∞Â¢ÉÈü≥Ê•Ω</div>
            </div>
            <div class="sound-type" data-sound="binaural">
                <div class="sound-icon">üß†</div>
                <div class="sound-title">„Éê„Ç§„Éé„Éº„É©„É´</div>
                <div class="sound-desc">ËÑ≥Ê≥¢ÂêåË™øÈü≥</div>
            </div>
            <div class="sound-type" data-sound="chimes">
                <div class="sound-icon">üéê</div>
                <div class="sound-title">„ÉÅ„É£„Ç§„É†</div>
                <div class="sound-desc">Ê∏Ö„Çâ„Åã„Å™Èü≥Ëâ≤</div>
            </div>
            <div class="sound-type" data-sound="meditation">
                <div class="sound-icon">üßò</div>
                <div class="sound-title">ÁûëÊÉ≥Èü≥Ê•Ω</div>
                <div class="sound-desc">ÂøÉ„ÇíËêΩ„Å°ÁùÄ„Åã„Åõ„Çã</div>
            </div>
        </div>

        <div class="volume-control">
            <label for="volumeSlider">Èü≥ÈáèË™øÊï¥</label>
            <input type="range" id="volumeSlider" class="volume-slider" min="0" max="100" value="50">
        </div>

        <div class="timer" id="timer">Ê∫ñÂÇôÂÆå‰∫Ü</div>

        <div class="stats-panel">
            <div class="stat-item">
                <div class="stat-label">„Çª„ÉÉ„Ç∑„Éß„É≥ÊôÇÈñì</div>
                <div class="stat-value" id="sessionTime">0ÂàÜ</div>
            </div>
            <div class="stat-item">
                <div class="stat-label">ÈÅ∏ÊäûÈü≥</div>
                <div class="stat-value" id="selectedSounds">0ÂÄã</div>
            </div>
            <div class="stat-item">
                <div class="stat-label">Èü≥Èáè</div>
                <div class="stat-value" id="currentVolume">50%</div>
            </div>
            <div class="stat-item">
                <div class="stat-label">Áä∂ÊÖã</div>
                <div class="stat-value" id="sessionStatus">ÂÅúÊ≠¢‰∏≠</div>
            </div>
        </div>

        <div class="controls">
            <button class="control-btn" id="startBtn">ÈñãÂßã</button>
            <button class="control-btn" id="pauseBtn" disabled>‰∏ÄÊôÇÂÅúÊ≠¢</button>
            <button class="control-btn" onclick="resetSession()">„É™„Çª„ÉÉ„Éà</button>
        </div>

        <div class="result-panel" id="resultPanel" style="display:none;">
            <h3>üìä „Çª„ÉÉ„Ç∑„Éß„É≥ÁµêÊûú</h3>
            <div id="resultContent"></div>
        </div>

        <div class="performance-rating" id="performanceRating" style="display:none;"></div>

        <a href="brain_training_game.html" class="back-button">‚Üê „Ç≤„Éº„É†‰∏ÄË¶ß„Å´Êàª„Çã</a>
    </div>

    <script>
        // „Ç≤„Éº„É†Áä∂ÊÖã
        let isPlaying = false;
        let isPaused = false;
        let currentSession = 'relaxation';
        let selectedSounds = [];
        let sessionStartTime = 0;
        let sessionDuration = 0;
        let currentVolume = 50;
        let audioContext = null;
        let oscillators = [];

        // „Çª„ÉÉ„Ç∑„Éß„É≥Ë®≠ÂÆö
        const sessionSettings = {
            relaxation: {
                name: '„É™„É©„ÇØ„Çº„Éº„Ç∑„Éß„É≥',
                duration: 15,
                sounds: ['nature', 'ocean', 'ambient'],
                description: 'ÂøÉË∫´„Çí„É™„É©„ÉÉ„ÇØ„Çπ„Åï„Åõ„ÇãÈü≥„ÅÆÁµÑ„ÅøÂêà„Çè„Åõ'
            },
            meditation: {
                name: 'ÁûëÊÉ≥',
                duration: 20,
                sounds: ['binaural', 'meditation', 'chimes'],
                description: 'ÁûëÊÉ≥„Å´ÊúÄÈÅ©„Å™Èü≥„ÅÆÁµÑ„ÅøÂêà„Çè„Åõ'
            },
            sleep: {
                name: 'Áù°Áú†',
                duration: 30,
                sounds: ['white-noise', 'ocean', 'ambient'],
                description: 'ÂÆâÁú†„Çí‰øÉÈÄ≤„Åô„ÇãÈü≥„ÅÆÁµÑ„ÅøÂêà„Çè„Åõ'
            },
            focus: {
                name: 'ÈõÜ‰∏≠',
                duration: 25,
                sounds: ['binaural', 'white-noise', 'ambient'],
                description: 'ÈõÜ‰∏≠Âäõ„ÇíÈ´ò„ÇÅ„ÇãÈü≥„ÅÆÁµÑ„ÅøÂêà„Çè„Åõ'
            },
            custom: {
                name: '„Ç´„Çπ„Çø„É†',
                duration: 20,
                sounds: [],
                description: 'Ëá™Áî±„Å´Èü≥„ÇíÁµÑ„ÅøÂêà„Çè„Åõ'
            }
        };

        // Èü≥„ÅÆË®≠ÂÆö
        const soundSettings = {
            nature: { frequency: 432, type: 'sine', description: 'Ëá™ÁÑ∂„ÅÆË™øÂíåÈü≥' },
            ocean: { frequency: 396, type: 'sine', description: 'Êµ∑„ÅÆÊ≥¢„ÅÆÈü≥' },
            forest: { frequency: 528, type: 'sine', description: 'Ê£Æ„ÅÆ„Åñ„Çè„ÇÅ„Åç' },
            'white-noise': { frequency: 0, type: 'noise', description: '„Éõ„ÉØ„Ç§„Éà„Éé„Ç§„Ç∫' },
            ambient: { frequency: 639, type: 'sine', description: 'Áí∞Â¢ÉÈü≥Ê•Ω' },
            binaural: { frequency: 183, type: 'binaural', description: '„Éê„Ç§„Éé„Éº„É©„É´„Éì„Éº„Éà' },
            chimes: { frequency: 741, type: 'sine', description: 'Ê∏Ö„Çâ„Åã„Å™„ÉÅ„É£„Ç§„É†' },
            meditation: { frequency: 852, type: 'sine', description: 'ÁûëÊÉ≥Èü≥Ê•Ω' }
        };

        // DOMË¶ÅÁ¥†
        const timerElem = document.getElementById('timer');
        const sessionTimeElem = document.getElementById('sessionTime');
        const selectedSoundsElem = document.getElementById('selectedSounds');
        const currentVolumeElem = document.getElementById('currentVolume');
        const sessionStatusElem = document.getElementById('sessionStatus');
        const startBtn = document.getElementById('startBtn');
        const pauseBtn = document.getElementById('pauseBtn');
        const resultPanel = document.getElementById('resultPanel');
        const resultContent = document.getElementById('resultContent');
        const performanceRating = document.getElementById('performanceRating');
        const volumeSlider = document.getElementById('volumeSlider');

        // „Çª„ÉÉ„Ç∑„Éß„É≥ÈÅ∏Êäû
        document.querySelectorAll('.session-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.session-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentSession = btn.dataset.session;
                updateSessionInfo();
            });
        });

        // Èü≥ÈÅ∏Êäû
        document.querySelectorAll('.sound-type').forEach(sound => {
            sound.addEventListener('click', () => {
                const soundType = sound.dataset.sound;
                if (selectedSounds.includes(soundType)) {
                    selectedSounds = selectedSounds.filter(s => s !== soundType);
                    sound.classList.remove('active');
                } else {
                    selectedSounds.push(soundType);
                    sound.classList.add('active');
                }
                updateStats();
            });
        });

        // Èü≥ÈáèË™øÊï¥
        volumeSlider.addEventListener('input', (e) => {
            currentVolume = parseInt(e.target.value);
            updateVolume();
            updateStats();
        });

        function updateSessionInfo() {
            const session = sessionSettings[currentSession];
            console.log(`„Çª„ÉÉ„Ç∑„Éß„É≥Â§âÊõ¥: ${session.name} - ${session.description}`);
            
            if (currentSession !== 'custom') {
                // „Éó„É™„Çª„ÉÉ„ÉàÈü≥„ÇíÈÅ∏Êäû
                selectedSounds = [...session.sounds];
                document.querySelectorAll('.sound-type').forEach(sound => {
                    const soundType = sound.dataset.sound;
                    if (selectedSounds.includes(soundType)) {
                        sound.classList.add('active');
                    } else {
                        sound.classList.remove('active');
                    }
                });
            }
            
            updateStats();
        }

        function updateStats() {
            selectedSoundsElem.textContent = `${selectedSounds.length}ÂÄã`;
            currentVolumeElem.textContent = `${currentVolume}%`;
            
            if (isPlaying) {
                sessionStatusElem.textContent = 'ÂÜçÁîü‰∏≠';
            } else if (isPaused) {
                sessionStatusElem.textContent = '‰∏ÄÊôÇÂÅúÊ≠¢';
            } else {
                sessionStatusElem.textContent = 'ÂÅúÊ≠¢‰∏≠';
            }
            
            if (sessionStartTime > 0) {
                sessionDuration = Math.floor((Date.now() - sessionStartTime) / 1000 / 60);
                sessionTimeElem.textContent = `${sessionDuration}ÂàÜ`;
            }
        }

        function updateVolume() {
            oscillators.forEach(osc => {
                if (osc.gainNode) {
                    osc.gainNode.gain.setValueAtTime(currentVolume / 100 * 0.3, audioContext.currentTime);
                }
            });
        }

        function createAudioContext() {
            if (!audioContext) {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
            }
        }

        function playSound(soundType) {
            if (!audioContext) return;
            
            const sound = soundSettings[soundType];
            if (!sound) return;
            
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            if (sound.type === 'noise') {
                // „Éõ„ÉØ„Ç§„Éà„Éé„Ç§„Ç∫„ÅÆÁîüÊàê
                const bufferSize = audioContext.sampleRate * 2;
                const noiseBuffer = audioContext.createBuffer(1, bufferSize, audioContext.sampleRate);
                const output = noiseBuffer.getChannelData(0);
                
                for (let i = 0; i < bufferSize; i++) {
                    output[i] = Math.random() * 2 - 1;
                }
                
                const noise = audioContext.createBufferSource();
                noise.buffer = noiseBuffer;
                noise.connect(gainNode);
                noise.start();
                oscillators.push({ oscillator: noise, gainNode });
            } else if (sound.type === 'binaural') {
                // „Éê„Ç§„Éé„Éº„É©„É´„Éì„Éº„Éà
                oscillator.frequency.setValueAtTime(sound.frequency, audioContext.currentTime);
                oscillator.frequency.setValueAtTime(sound.frequency + 10, audioContext.currentTime + 0.1);
                oscillator.start();
                oscillators.push({ oscillator, gainNode });
            } else {
                // ÈÄöÂ∏∏„ÅÆÈü≥
                oscillator.type = sound.type;
                oscillator.frequency.setValueAtTime(sound.frequency, audioContext.currentTime);
                oscillator.start();
                oscillators.push({ oscillator, gainNode });
            }
            
            gainNode.gain.setValueAtTime(currentVolume / 100 * 0.3, audioContext.currentTime);
        }

        function stopAllSounds() {
            oscillators.forEach(osc => {
                if (osc.oscillator) {
                    osc.oscillator.stop();
                }
            });
            oscillators = [];
        }

        function startSession() {
            if (selectedSounds.length === 0) {
                alert('Èü≥„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ');
                return;
            }
            
            createAudioContext();
            
            isPlaying = true;
            isPaused = false;
            sessionStartTime = Date.now();
            
            startBtn.disabled = true;
            pauseBtn.disabled = false;
            resultPanel.style.display = 'none';
            performanceRating.style.display = 'none';
            
            // ÈÅ∏Êäû„Åï„Çå„ÅüÈü≥„ÇíÂÜçÁîü
            selectedSounds.forEach(soundType => {
                playSound(soundType);
            });
            
            updateStats();
            timerElem.textContent = '„Çª„ÉÉ„Ç∑„Éß„É≥‰∏≠...';
            
            // „Çª„ÉÉ„Ç∑„Éß„É≥ÁµÇ‰∫Ü„Çø„Ç§„Éû„Éº
            const session = sessionSettings[currentSession];
            setTimeout(() => {
                if (isPlaying) {
                    endSession();
                }
            }, session.duration * 60 * 1000);
        }

        function pauseSession() {
            if (!isPlaying) return;
            
            isPaused = !isPaused;
            pauseBtn.textContent = isPaused ? 'ÂÜçÈñã' : '‰∏ÄÊôÇÂÅúÊ≠¢';
            pauseBtn.classList.toggle('paused', isPaused);
            
            if (isPaused) {
                audioContext.suspend();
                timerElem.textContent = '‰∏ÄÊôÇÂÅúÊ≠¢‰∏≠';
            } else {
                audioContext.resume();
                timerElem.textContent = '„Çª„ÉÉ„Ç∑„Éß„É≥‰∏≠...';
            }
            
            updateStats();
        }

        function endSession() {
            isPlaying = false;
            isPaused = false;
            
            stopAllSounds();
            
            startBtn.disabled = false;
            pauseBtn.disabled = true;
            pauseBtn.textContent = '‰∏ÄÊôÇÂÅúÊ≠¢';
            pauseBtn.classList.remove('paused');
            
            timerElem.textContent = '„Çª„ÉÉ„Ç∑„Éß„É≥ÂÆå‰∫Ü';
            
            const session = sessionSettings[currentSession];
            const totalSounds = selectedSounds.length;
            const sessionQuality = Math.round((sessionDuration / session.duration) * 100);
            
            // ÁµêÊûúË°®Á§∫
            resultContent.innerHTML = `
                <div><strong>„Çª„ÉÉ„Ç∑„Éß„É≥:</strong> ${session.name}</div>
                <div><strong>‰ΩøÁî®Èü≥:</strong> ${totalSounds}ÂÄã</div>
                <div><strong>„Çª„ÉÉ„Ç∑„Éß„É≥ÊôÇÈñì:</strong> ${sessionDuration}ÂàÜ</div>
                <div><strong>ÁõÆÊ®ôÊôÇÈñì:</strong> ${session.duration}ÂàÜ</div>
                <div><strong>ÂÆå‰∫ÜÁéá:</strong> ${sessionQuality}%</div>
                <div><strong>Èü≥ÈáèË®≠ÂÆö:</strong> ${currentVolume}%</div>
            `;
            
            resultPanel.style.display = 'block';
            
            // „Éë„Éï„Ç©„Éº„Éû„É≥„ÇπË©ï‰æ°
            let rating, ratingClass;
            if (sessionQuality >= 100) {
                rating = 'üåü ÂÆåÁíßÔºÅÁ¥†Êô¥„Çâ„Åó„ÅÑ„É™„É©„ÇØ„Çº„Éº„Ç∑„Éß„É≥„Çª„ÉÉ„Ç∑„Éß„É≥„Åß„Åó„ÅüÔºÅ';
                ratingClass = 'rating-excellent';
            } else if (sessionQuality >= 80) {
                rating = 'üëç ÂÑ™ÁßÄÔºÅ„Å®„Å¶„ÇÇËâØ„ÅÑ„É™„É©„ÇØ„Çº„Éº„Ç∑„Éß„É≥ÂäπÊûú„ÅåÂæó„Çâ„Çå„Åæ„Åó„ÅüÔºÅ';
                ratingClass = 'rating-good';
            } else if (sessionQuality >= 60) {
                rating = 'üëå ËâØÂ•ΩÔºÅ„É™„É©„ÇØ„Çº„Éº„Ç∑„Éß„É≥ÂäπÊûú„ÅåÂæó„Çâ„Çå„Åæ„Åó„ÅüÔºÅ';
                ratingClass = 'rating-average';
            } else {
                rating = 'üí™ ÂàùÂõûÊåëÊà¶ÔºÅÊ¨°Âõû„ÅØ„ÇÇ„Å£„Å®„É™„É©„ÉÉ„ÇØ„Çπ„Åó„Åæ„Åó„Çá„ÅÜÔºÅ';
                ratingClass = 'rating-poor';
            }
            
            performanceRating.textContent = rating;
            performanceRating.className = `performance-rating ${ratingClass}`;
            performanceRating.style.display = 'block';
        }

        function resetSession() {
            isPlaying = false;
            isPaused = false;
            sessionStartTime = 0;
            sessionDuration = 0;
            
            stopAllSounds();
            
            selectedSounds = [];
            document.querySelectorAll('.sound-type').forEach(sound => {
                sound.classList.remove('active');
            });
            
            updateStats();
            resultPanel.style.display = 'none';
            performanceRating.style.display = 'none';
            
            startBtn.disabled = false;
            pauseBtn.disabled = true;
            pauseBtn.textContent = '‰∏ÄÊôÇÂÅúÊ≠¢';
            pauseBtn.classList.remove('paused');
            
            timerElem.textContent = 'Ê∫ñÂÇôÂÆå‰∫Ü';
        }

        // „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº
        startBtn.addEventListener('click', startSession);
        pauseBtn.addEventListener('click', pauseSession);

        // ÂàùÊúüÂåñ
        updateSessionInfo();
        resetSession();
    </script>
</body>
</html> 