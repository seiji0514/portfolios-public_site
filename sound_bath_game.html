<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚µã‚¦ãƒ³ãƒ‰ãƒã‚¹ éŸ³éŸ¿ãƒªãƒ©ã‚¯ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', 'Meiryo', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            text-align: center;
            max-width: 1000px;
            width: 100%;
        }

        h1 {
            color: #333;
            margin-bottom: 30px;
            font-size: 2.5em;
        }

        .session-selector {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .session-btn {
            background: #f8f9fa;
            color: #333;
            border: 2px solid #ddd;
            padding: 15px 25px;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1em;
            min-width: 150px;
        }

        .session-btn:hover {
            background: #e9ecef;
            border-color: #667eea;
            transform: translateY(-2px);
        }

        .session-btn.active {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border-color: #667eea;
        }

        .sound-visualizer {
            width: 100%;
            height: 300px;
            background: linear-gradient(180deg, #0B1426 0%, #1a1a2e 100%);
            position: relative;
            overflow: hidden;
            border-radius: 15px;
            margin: 30px 0;
            border: 3px solid #333;
        }

        .sound-wave {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 100px;
            background: linear-gradient(180deg, transparent, rgba(102, 126, 234, 0.3));
            border-radius: 50% 50% 0 0;
            animation: wave 3s infinite ease-in-out;
        }

        .sound-wave:nth-child(2) {
            animation-delay: -1s;
            background: linear-gradient(180deg, transparent, rgba(76, 175, 80, 0.3));
        }

        .sound-wave:nth-child(3) {
            animation-delay: -2s;
            background: linear-gradient(180deg, transparent, rgba(255, 193, 7, 0.3));
        }

        .sound-wave:nth-child(4) {
            animation-delay: -0.5s;
            background: linear-gradient(180deg, transparent, rgba(156, 39, 176, 0.3));
        }

        @keyframes wave {
            0%, 100% { 
                transform: translateY(0) scaleY(1); 
            }
            50% { 
                transform: translateY(-30px) scaleY(1.3); 
            }
        }

        .frequency-display {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .frequency-bar {
            width: 8px;
            background: linear-gradient(180deg, #667eea, #764ba2);
            border-radius: 4px;
            animation: frequency 2s infinite ease-in-out;
        }

        .frequency-bar:nth-child(1) { height: 60px; animation-delay: 0s; }
        .frequency-bar:nth-child(2) { height: 80px; animation-delay: 0.2s; }
        .frequency-bar:nth-child(3) { height: 100px; animation-delay: 0.4s; }
        .frequency-bar:nth-child(4) { height: 120px; animation-delay: 0.6s; }
        .frequency-bar:nth-child(5) { height: 140px; animation-delay: 0.8s; }
        .frequency-bar:nth-child(6) { height: 120px; animation-delay: 1s; }
        .frequency-bar:nth-child(7) { height: 100px; animation-delay: 1.2s; }
        .frequency-bar:nth-child(8) { height: 80px; animation-delay: 1.4s; }
        .frequency-bar:nth-child(9) { height: 60px; animation-delay: 1.6s; }

        @keyframes frequency {
            0%, 100% { transform: scaleY(1); }
            50% { transform: scaleY(1.5); }
        }

        .sound-types {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 30px 0;
        }

        .sound-type {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .sound-type:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            border-color: #667eea;
        }

        .sound-type.active {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border-color: #667eea;
        }

        .sound-icon {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .volume-control {
            margin: 20px 0;
        }

        .volume-control label {
            display: block;
            margin-bottom: 10px;
            color: #333;
            font-weight: bold;
        }

        .volume-slider {
            width: 100%;
            max-width: 300px;
            height: 8px;
            border-radius: 5px;
            background: #ddd;
            outline: none;
            -webkit-appearance: none;
        }

        .volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
        }

        .volume-slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
            border: none;
        }

        .timer {
            font-size: 2.5em;
            color: #333;
            margin: 20px 0;
            font-weight: bold;
        }

        .stats-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .stat-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            border: 1px solid #e9ecef;
        }

        .stat-label {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 1.3em;
            font-weight: bold;
            color: #667eea;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .control-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1em;
        }

        .control-btn:hover {
            background: #5a6fd8;
            transform: scale(1.05);
        }

        .control-btn.paused {
            background: #ff9800;
        }

        .back-button {
            background: #6c757d;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            margin-top: 20px;
        }

        .back-button:hover {
            background: #5a6268;
            transform: scale(1.05);
        }

        .result-panel {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            text-align: left;
        }

        .result-panel h3 {
            color: #667eea;
            margin-bottom: 15px;
        }

        .performance-rating {
            font-size: 1.5em;
            font-weight: bold;
            margin: 1em 0;
            padding: 0.8em;
            border-radius: 10px;
        }

        .rating-excellent { background: #d4edda; color: #155724; }
        .rating-good { background: #d1ecf1; color: #0c5460; }
        .rating-average { background: #fff3cd; color: #856404; }
        .rating-poor { background: #f8d7da; color: #721c24; }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            .sound-visualizer {
                height: 250px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸµ ã‚µã‚¦ãƒ³ãƒ‰ãƒã‚¹ éŸ³éŸ¿ãƒªãƒ©ã‚¯ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³</h1>
        <div class="description">
            ç™’ã—ã®éŸ³ã§ãƒªãƒ©ã‚¯ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½“é¨“ã—ã¾ã—ã‚‡ã†ã€‚æ§˜ã€…ãªéŸ³ã®çµ„ã¿åˆã‚ã›ã§å¿ƒèº«ã‚’ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ã§ãã¾ã™ã€‚
        </div>

        <div class="session-selector">
            <button class="session-btn active" data-session="relaxation">ãƒªãƒ©ã‚¯ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³</button>
            <button class="session-btn" data-session="meditation">ç‘æƒ³</button>
            <button class="session-btn" data-session="sleep">ç¡çœ </button>
            <button class="session-btn" data-session="focus">é›†ä¸­</button>
            <button class="session-btn" data-session="custom">ã‚«ã‚¹ã‚¿ãƒ </button>
        </div>

        <div class="sound-visualizer" id="soundVisualizer">
            <div class="sound-wave"></div>
            <div class="sound-wave"></div>
            <div class="sound-wave"></div>
            <div class="sound-wave"></div>
        </div>

        <div class="frequency-display" id="frequencyDisplay">
            <div class="frequency-bar"></div>
            <div class="frequency-bar"></div>
            <div class="frequency-bar"></div>
            <div class="frequency-bar"></div>
            <div class="frequency-bar"></div>
            <div class="frequency-bar"></div>
            <div class="frequency-bar"></div>
            <div class="frequency-bar"></div>
            <div class="frequency-bar"></div>
        </div>

        <div class="sound-types">
            <div class="sound-type" data-sound="nature">
                <div class="sound-icon">ğŸŒ¿</div>
                <div class="sound-title">è‡ªç„¶éŸ³</div>
                <div class="sound-desc">é›¨ã€é¢¨ã€é³¥ã®ã•ãˆãšã‚Š</div>
            </div>
            <div class="sound-type" data-sound="ocean">
                <div class="sound-icon">ğŸŒŠ</div>
                <div class="sound-title">æµ·ã®éŸ³</div>
                <div class="sound-desc">æ³¢ã®éŸ³ã€æ½®é¨’</div>
            </div>
            <div class="sound-type" data-sound="forest">
                <div class="sound-icon">ğŸŒ²</div>
                <div class="sound-title">æ£®ã®éŸ³</div>
                <div class="sound-desc">æœ¨ã€…ã®ã–ã‚ã‚ãã€å°å·</div>
            </div>
            <div class="sound-type" data-sound="white-noise">
                <div class="sound-icon">âšª</div>
                <div class="sound-title">ãƒ›ãƒ¯ã‚¤ãƒˆãƒã‚¤ã‚º</div>
                <div class="sound-desc">é™å¯‚ã‚’æ¼”å‡º</div>
            </div>
            <div class="sound-type" data-sound="ambient">
                <div class="sound-icon">ğŸ¼</div>
                <div class="sound-title">ã‚¢ãƒ³ãƒ“ã‚¨ãƒ³ãƒˆ</div>
                <div class="sound-desc">ç’°å¢ƒéŸ³æ¥½</div>
            </div>
            <div class="sound-type" data-sound="binaural">
                <div class="sound-icon">ğŸ§ </div>
                <div class="sound-title">ãƒã‚¤ãƒãƒ¼ãƒ©ãƒ«</div>
                <div class="sound-desc">è„³æ³¢åŒèª¿éŸ³</div>
            </div>
            <div class="sound-type" data-sound="chimes">
                <div class="sound-icon">ğŸ</div>
                <div class="sound-title">ãƒãƒ£ã‚¤ãƒ </div>
                <div class="sound-desc">æ¸…ã‚‰ã‹ãªéŸ³è‰²</div>
            </div>
            <div class="sound-type" data-sound="meditation">
                <div class="sound-icon">ğŸ§˜</div>
                <div class="sound-title">ç‘æƒ³éŸ³æ¥½</div>
                <div class="sound-desc">å¿ƒã‚’è½ã¡ç€ã‹ã›ã‚‹</div>
            </div>
        </div>

        <div class="volume-control">
            <label for="volumeSlider">éŸ³é‡èª¿æ•´</label>
            <input type="range" id="volumeSlider" class="volume-slider" min="0" max="100" value="50">
        </div>

        <div class="timer" id="timer">æº–å‚™å®Œäº†</div>

        <div class="stats-panel">
            <div class="stat-item">
                <div class="stat-label">ã‚»ãƒƒã‚·ãƒ§ãƒ³æ™‚é–“</div>
                <div class="stat-value" id="sessionTime">0åˆ†</div>
            </div>
            <div class="stat-item">
                <div class="stat-label">é¸æŠéŸ³</div>
                <div class="stat-value" id="selectedSounds">0å€‹</div>
            </div>
            <div class="stat-item">
                <div class="stat-label">éŸ³é‡</div>
                <div class="stat-value" id="currentVolume">50%</div>
            </div>
            <div class="stat-item">
                <div class="stat-label">çŠ¶æ…‹</div>
                <div class="stat-value" id="sessionStatus">åœæ­¢ä¸­</div>
            </div>
        </div>

        <div class="controls">
            <button class="control-btn" id="startBtn">é–‹å§‹</button>
            <button class="control-btn" id="pauseBtn" disabled>ä¸€æ™‚åœæ­¢</button>
            <button class="control-btn" onclick="resetSession()">ãƒªã‚»ãƒƒãƒˆ</button>
        </div>

        <div class="result-panel" id="resultPanel" style="display:none;">
            <h3>ğŸ“Š ã‚»ãƒƒã‚·ãƒ§ãƒ³çµæœ</h3>
            <div id="resultContent"></div>
        </div>

        <div class="performance-rating" id="performanceRating" style="display:none;"></div>

        <a href="brain_training_game.html" class="back-button">â† ã‚²ãƒ¼ãƒ ä¸€è¦§ã«æˆ»ã‚‹</a>
    </div>

    <script>
        // ã‚²ãƒ¼ãƒ çŠ¶æ…‹
        let isPlaying = false;
        let isPaused = false;
        let currentSession = 'relaxation';
        let selectedSounds = [];
        let sessionStartTime = 0;
        let sessionDuration = 0;
        let currentVolume = 50;
        let audioContext = null;
        let oscillators = [];

        // ã‚»ãƒƒã‚·ãƒ§ãƒ³è¨­å®š
        const sessionSettings = {
            relaxation: {
                name: 'ãƒªãƒ©ã‚¯ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³',
                duration: 15,
                sounds: ['nature', 'ocean', 'ambient'],
                description: 'å¿ƒèº«ã‚’ãƒªãƒ©ãƒƒã‚¯ã‚¹ã•ã›ã‚‹éŸ³ã®çµ„ã¿åˆã‚ã›'
            },
            meditation: {
                name: 'ç‘æƒ³',
                duration: 20,
                sounds: ['binaural', 'meditation', 'chimes'],
                description: 'ç‘æƒ³ã«æœ€é©ãªéŸ³ã®çµ„ã¿åˆã‚ã›'
            },
            sleep: {
                name: 'ç¡çœ ',
                duration: 30,
                sounds: ['white-noise', 'ocean', 'ambient'],
                description: 'å®‰çœ ã‚’ä¿ƒé€²ã™ã‚‹éŸ³ã®çµ„ã¿åˆã‚ã›'
            },
            focus: {
                name: 'é›†ä¸­',
                duration: 25,
                sounds: ['binaural', 'white-noise', 'ambient'],
                description: 'é›†ä¸­åŠ›ã‚’é«˜ã‚ã‚‹éŸ³ã®çµ„ã¿åˆã‚ã›'
            },
            custom: {
                name: 'ã‚«ã‚¹ã‚¿ãƒ ',
                duration: 20,
                sounds: [],
                description: 'è‡ªç”±ã«éŸ³ã‚’çµ„ã¿åˆã‚ã›'
            }
        };

        // éŸ³ã®è¨­å®š
        const soundSettings = {
            nature: { frequency: 432, type: 'sine', description: 'è‡ªç„¶ã®èª¿å’ŒéŸ³' },
            ocean: { frequency: 396, type: 'sine', description: 'æµ·ã®æ³¢ã®éŸ³' },
            forest: { frequency: 528, type: 'sine', description: 'æ£®ã®ã–ã‚ã‚ã' },
            'white-noise': { frequency: 0, type: 'noise', description: 'ãƒ›ãƒ¯ã‚¤ãƒˆãƒã‚¤ã‚º' },
            ambient: { frequency: 639, type: 'sine', description: 'ç’°å¢ƒéŸ³æ¥½' },
            binaural: { frequency: 183, type: 'binaural', description: 'ãƒã‚¤ãƒãƒ¼ãƒ©ãƒ«ãƒ“ãƒ¼ãƒˆ' },
            chimes: { frequency: 741, type: 'sine', description: 'æ¸…ã‚‰ã‹ãªãƒãƒ£ã‚¤ãƒ ' },
            meditation: { frequency: 852, type: 'sine', description: 'ç‘æƒ³éŸ³æ¥½' }
        };

        // DOMè¦ç´ 
        const timerElem = document.getElementById('timer');
        const sessionTimeElem = document.getElementById('sessionTime');
        const selectedSoundsElem = document.getElementById('selectedSounds');
        const currentVolumeElem = document.getElementById('currentVolume');
        const sessionStatusElem = document.getElementById('sessionStatus');
        const startBtn = document.getElementById('startBtn');
        const pauseBtn = document.getElementById('pauseBtn');
        const resultPanel = document.getElementById('resultPanel');
        const resultContent = document.getElementById('resultContent');
        const performanceRating = document.getElementById('performanceRating');
        const volumeSlider = document.getElementById('volumeSlider');

        // ã‚»ãƒƒã‚·ãƒ§ãƒ³é¸æŠ
        document.querySelectorAll('.session-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.session-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentSession = btn.dataset.session;
                updateSessionInfo();
            });
        });

        // éŸ³é¸æŠ
        document.querySelectorAll('.sound-type').forEach(sound => {
            sound.addEventListener('click', () => {
                const soundType = sound.dataset.sound;
                if (selectedSounds.includes(soundType)) {
                    selectedSounds = selectedSounds.filter(s => s !== soundType);
                    sound.classList.remove('active');
                } else {
                    selectedSounds.push(soundType);
                    sound.classList.add('active');
                }
                updateStats();
            });
        });

        // éŸ³é‡èª¿æ•´
        volumeSlider.addEventListener('input', (e) => {
            currentVolume = parseInt(e.target.value);
            updateVolume();
            updateStats();
        });

        function updateSessionInfo() {
            const session = sessionSettings[currentSession];
            console.log(`ã‚»ãƒƒã‚·ãƒ§ãƒ³å¤‰æ›´: ${session.name} - ${session.description}`);
            
            if (currentSession !== 'custom') {
                // ãƒ—ãƒªã‚»ãƒƒãƒˆéŸ³ã‚’é¸æŠ
                selectedSounds = [...session.sounds];
                document.querySelectorAll('.sound-type').forEach(sound => {
                    const soundType = sound.dataset.sound;
                    if (selectedSounds.includes(soundType)) {
                        sound.classList.add('active');
                    } else {
                        sound.classList.remove('active');
                    }
                });
            }
            
            updateStats();
        }

        function updateStats() {
            selectedSoundsElem.textContent = `${selectedSounds.length}å€‹`;
            currentVolumeElem.textContent = `${currentVolume}%`;
            
            if (isPlaying) {
                sessionStatusElem.textContent = 'å†ç”Ÿä¸­';
            } else if (isPaused) {
                sessionStatusElem.textContent = 'ä¸€æ™‚åœæ­¢';
            } else {
                sessionStatusElem.textContent = 'åœæ­¢ä¸­';
            }
            
            if (sessionStartTime > 0) {
                sessionDuration = Math.floor((Date.now() - sessionStartTime) / 1000 / 60);
                sessionTimeElem.textContent = `${sessionDuration}åˆ†`;
            }
        }

        function updateVolume() {
            oscillators.forEach(osc => {
                if (osc.gainNode) {
                    osc.gainNode.gain.setValueAtTime(currentVolume / 100 * 0.3, audioContext.currentTime);
                }
            });
        }

        function createAudioContext() {
            if (!audioContext) {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
            }
        }

        function playSound(soundType) {
            if (!audioContext) return;
            
            const sound = soundSettings[soundType];
            if (!sound) return;
            
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            if (sound.type === 'noise') {
                // ãƒ›ãƒ¯ã‚¤ãƒˆãƒã‚¤ã‚ºã®ç”Ÿæˆ
                const bufferSize = audioContext.sampleRate * 2;
                const noiseBuffer = audioContext.createBuffer(1, bufferSize, audioContext.sampleRate);
                const output = noiseBuffer.getChannelData(0);
                
                for (let i = 0; i < bufferSize; i++) {
                    output[i] = Math.random() * 2 - 1;
                }
                
                const noise = audioContext.createBufferSource();
                noise.buffer = noiseBuffer;
                noise.connect(gainNode);
                noise.start();
                oscillators.push({ oscillator: noise, gainNode });
            } else if (sound.type === 'binaural') {
                // ãƒã‚¤ãƒãƒ¼ãƒ©ãƒ«ãƒ“ãƒ¼ãƒˆ
                oscillator.frequency.setValueAtTime(sound.frequency, audioContext.currentTime);
                oscillator.frequency.setValueAtTime(sound.frequency + 10, audioContext.currentTime + 0.1);
                oscillator.start();
                oscillators.push({ oscillator, gainNode });
            } else {
                // é€šå¸¸ã®éŸ³
                oscillator.type = sound.type;
                oscillator.frequency.setValueAtTime(sound.frequency, audioContext.currentTime);
                oscillator.start();
                oscillators.push({ oscillator, gainNode });
            }
            
            gainNode.gain.setValueAtTime(currentVolume / 100 * 0.3, audioContext.currentTime);
        }

        function stopAllSounds() {
            oscillators.forEach(osc => {
                if (osc.oscillator) {
                    osc.oscillator.stop();
                }
            });
            oscillators = [];
        }

        function startSession() {
            if (selectedSounds.length === 0) {
                alert('éŸ³ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚');
                return;
            }
            
            createAudioContext();
            
            isPlaying = true;
            isPaused = false;
            sessionStartTime = Date.now();
            
            startBtn.disabled = true;
            pauseBtn.disabled = false;
            resultPanel.style.display = 'none';
            performanceRating.style.display = 'none';
            
            // é¸æŠã•ã‚ŒãŸéŸ³ã‚’å†ç”Ÿ
            selectedSounds.forEach(soundType => {
                playSound(soundType);
            });
            
            updateStats();
            timerElem.textContent = 'ã‚»ãƒƒã‚·ãƒ§ãƒ³ä¸­...';
            
            // ã‚»ãƒƒã‚·ãƒ§ãƒ³çµ‚äº†ã‚¿ã‚¤ãƒãƒ¼
            const session = sessionSettings[currentSession];
            setTimeout(() => {
                if (isPlaying) {
                    endSession();
                }
            }, session.duration * 60 * 1000);
        }

        function pauseSession() {
            if (!isPlaying) return;
            
            isPaused = !isPaused;
            pauseBtn.textContent = isPaused ? 'å†é–‹' : 'ä¸€æ™‚åœæ­¢';
            pauseBtn.classList.toggle('paused', isPaused);
            
            if (isPaused) {
                audioContext.suspend();
                timerElem.textContent = 'ä¸€æ™‚åœæ­¢ä¸­';
            } else {
                audioContext.resume();
                timerElem.textContent = 'ã‚»ãƒƒã‚·ãƒ§ãƒ³ä¸­...';
            }
            
            updateStats();
        }

        function endSession() {
            isPlaying = false;
            isPaused = false;
            
            stopAllSounds();
            
            startBtn.disabled = false;
            pauseBtn.disabled = true;
            pauseBtn.textContent = 'ä¸€æ™‚åœæ­¢';
            pauseBtn.classList.remove('paused');
            
            timerElem.textContent = 'ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†';
            
            const session = sessionSettings[currentSession];
            const totalSounds = selectedSounds.length;
            const sessionQuality = Math.round((sessionDuration / session.duration) * 100);
            
            // çµæœè¡¨ç¤º
            resultContent.innerHTML = `
                <div><strong>ã‚»ãƒƒã‚·ãƒ§ãƒ³:</strong> ${session.name}</div>
                <div><strong>ä½¿ç”¨éŸ³:</strong> ${totalSounds}å€‹</div>
                <div><strong>ã‚»ãƒƒã‚·ãƒ§ãƒ³æ™‚é–“:</strong> ${sessionDuration}åˆ†</div>
                <div><strong>ç›®æ¨™æ™‚é–“:</strong> ${session.duration}åˆ†</div>
                <div><strong>å®Œäº†ç‡:</strong> ${sessionQuality}%</div>
                <div><strong>éŸ³é‡è¨­å®š:</strong> ${currentVolume}%</div>
            `;
            
            resultPanel.style.display = 'block';
            
            // ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è©•ä¾¡
            let rating, ratingClass;
            if (sessionQuality >= 100) {
                rating = 'ğŸŒŸ å®Œç’§ï¼ç´ æ™´ã‚‰ã—ã„ãƒªãƒ©ã‚¯ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§ã—ãŸï¼';
                ratingClass = 'rating-excellent';
            } else if (sessionQuality >= 80) {
                rating = 'ğŸ‘ å„ªç§€ï¼ã¨ã¦ã‚‚è‰¯ã„ãƒªãƒ©ã‚¯ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³åŠ¹æœãŒå¾—ã‚‰ã‚Œã¾ã—ãŸï¼';
                ratingClass = 'rating-good';
            } else if (sessionQuality >= 60) {
                rating = 'ğŸ‘Œ è‰¯å¥½ï¼ãƒªãƒ©ã‚¯ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³åŠ¹æœãŒå¾—ã‚‰ã‚Œã¾ã—ãŸï¼';
                ratingClass = 'rating-average';
            } else {
                rating = 'ğŸ’ª åˆå›æŒ‘æˆ¦ï¼æ¬¡å›ã¯ã‚‚ã£ã¨ãƒªãƒ©ãƒƒã‚¯ã‚¹ã—ã¾ã—ã‚‡ã†ï¼';
                ratingClass = 'rating-poor';
            }
            
            performanceRating.textContent = rating;
            performanceRating.className = `performance-rating ${ratingClass}`;
            performanceRating.style.display = 'block';
        }

        function resetSession() {
            isPlaying = false;
            isPaused = false;
            sessionStartTime = 0;
            sessionDuration = 0;
            
            stopAllSounds();
            
            selectedSounds = [];
            document.querySelectorAll('.sound-type').forEach(sound => {
                sound.classList.remove('active');
            });
            
            updateStats();
            resultPanel.style.display = 'none';
            performanceRating.style.display = 'none';
            
            startBtn.disabled = false;
            pauseBtn.disabled = true;
            pauseBtn.textContent = 'ä¸€æ™‚åœæ­¢';
            pauseBtn.classList.remove('paused');
            
            timerElem.textContent = 'æº–å‚™å®Œäº†';
        }

        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
        startBtn.addEventListener('click', startSession);
        pauseBtn.addEventListener('click', pauseSession);

        // åˆæœŸåŒ–
        updateSessionInfo();
        resetSession();
    </script>
</body>
</html> 